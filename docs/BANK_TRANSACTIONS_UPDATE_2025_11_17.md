# Bank Transactions - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç 17 –Ω–æ—è–±—Ä—è 2025

## üéâ –ì–ª–∞–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**–°—Ç–∞—Ç—É—Å –º–æ–¥—É–ª—è:** 100% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (+15% –∑–∞ –¥–µ–Ω—å) üéä

–í—ã–ø–æ–ª–Ω–µ–Ω—ã –í–°–ï –∑–∞–¥–∞—á–∏ –∏–∑ –¢–ó, –≤–∫–ª—é—á–∞—è –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é!

---

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Å–µ–≥–æ–¥–Ω—è

### 1. **PaymentSourceEnum (BANK/CASH)** - –ü–æ–ª–Ω—ã–π —Å—Ç–µ–∫

**Backend:**
- ‚úÖ Enum `PaymentSourceEnum` –≤ [models.py:154-157](../backend/app/db/models.py#L154)
- ‚úÖ –ü–æ–ª–µ `payment_source` –≤ –º–æ–¥–µ–ª–∏ `BankTransaction` —Å –∏–Ω–¥–µ–∫—Å–æ–º
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è `2025_11_17_0612-6bad3b34ad66` —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- ‚úÖ Pydantic schemas –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ API —Ñ–∏–ª—å—Ç—Ä—ã: `GET /bank-transactions` –∏ `GET /stats`

**Frontend:**
- ‚úÖ Select "–ò—Å—Ç–æ—á–Ω–∏–∫" (üè¶ –ë–∞–Ω–∫ / üíµ –ö–∞—Å—Å–∞)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- ‚úÖ TypeScript —Ç–∏–ø—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã

**–§–∞–π–ª—ã:**
- [backend/app/db/models.py](../backend/app/db/models.py#L1696-1702)
- [backend/app/api/v1/bank_transactions.py](../backend/app/api/v1/bank_transactions.py#L177-240)
- [frontend/src/pages/BankTransactionsPage.tsx](../frontend/src/pages/BankTransactionsPage.tsx#L855-865)

---

### 2. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏**

Endpoint `GET /stats` —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –í–°–ï —Ñ–∏–ª—å—Ç—Ä—ã:
- ‚úÖ `status` - —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ `transaction_type` - DEBIT/CREDIT
- ‚úÖ `payment_source` - BANK/CASH
- ‚úÖ `search` - –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É
- ‚úÖ `date_from`, `date_to` - –ø–µ—Ä–∏–æ–¥

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞!

**–§–∞–π–ª—ã:**
- [backend/app/api/v1/bank_transactions.py:177-240](../backend/app/api/v1/bank_transactions.py#L177)
- [frontend/src/pages/BankTransactionsPage.tsx:116-136](../frontend/src/pages/BankTransactionsPage.tsx#L116)

---

### 3. **–ú–µ—Ç–∫–∞ "–ê–≤—Ç–æ" –¥–ª—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π**

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π (confidence ‚â• 90%) —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –∑–µ–ª–µ–Ω–æ–π –º–µ—Ç–∫–æ–π "–ê–≤—Ç–æ".

**–ü—Ä–∏–º–µ—Ä:**
```
[–ê—Ä–µ–Ω–¥–∞ –ø–æ–º–µ—â–µ–Ω–∏–π (95%)] [–ê–≤—Ç–æ]
```

**–§–∞–π–ª—ã:**
- [frontend/src/pages/BankTransactionsPage.tsx:388-404](../frontend/src/pages/BankTransactionsPage.tsx#L388)

---

### 4. **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ "–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ (–ø—Ä–∏—Ö–æ–¥)" –∏ "–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ (—Ä–∞—Å—Ö–æ–¥)"**

**–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç:**
```bash
backend/scripts/add_customer_supplier_categories.py
```

**–î–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:**
- "–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ (–ø—Ä–∏—Ö–æ–¥)" - –¥–ª—è CREDIT —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–¥–æ—Ö–æ–¥—ã)
- "–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ (—Ä–∞—Å—Ö–æ–¥)" - –¥–ª—è DEBIT —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (—Ä–∞—Å—Ö–æ–¥—ã)
- –°–æ–∑–¥–∞–Ω—ã –¥–ª—è **–≤—Å–µ—Ö 8 –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ç–¥–µ–ª–æ–≤** (16 –∫–∞—Ç–µ–≥–æ—Ä–∏–π total)

**–ó–∞–ø—É—Å–∫:**
```bash
cd backend
export DEBUG=true
source venv/bin/activate
echo "1" | python scripts/add_customer_supplier_categories.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π: 16
‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç): 0
```

---

### 5. **–£–ª—É—á—à–µ–Ω–Ω—ã–π AI Classifier —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π –æ–ø–µ—Ä–∞—Ü–∏–π**

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

#### 5.1. –ù–æ–≤—ã–µ —Å–ª–æ–≤–∞—Ä–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
```python
REVENUE_KEYWORDS = {
    '–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ (–ø—Ä–∏—Ö–æ–¥)': [
        '–ø–æ–∫—É–ø–∞—Ç–µ–ª—å', 'customer', '–∫–ª–∏–µ–Ω—Ç', '–æ–ø–ª–∞—Ç–∞ —Å—á–µ—Ç–∞',
        '–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ', '–ø—Ä–∏—Ö–æ–¥', '–≤—ã—Ä—É—á–∫–∞', '–∞–≤–∞–Ω—Å', ...
    ]
}

SUPPLIER_KEYWORDS = {
    '–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ (—Ä–∞—Å—Ö–æ–¥)': [
        '–ø–æ—Å—Ç–∞–≤—â–∏–∫', 'supplier', 'vendor', '–∑–∞–∫—É–ø–∫–∞',
        '–ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ', '–ø–æ–∫—É–ø–∫–∞', '–æ–ø–ª–∞—Ç–∞ —Ç–æ–≤–∞—Ä–∞', ...
    ]
}
```

#### 5.2. –ú–µ—Ç–æ–¥ `classify()` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º transaction_type
```python
category_id, confidence, reasoning = classifier.classify(
    payment_purpose=...,
    counterparty_name=...,
    counterparty_inn=...,
    amount=...,
    department_id=...,
    transaction_type='CREDIT'  # –ù–û–í–û–ï!
)
```

#### 5.3. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É –æ–ø–µ—Ä–∞—Ü–∏–∏
- **CREDIT** ‚Üí –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç `REVENUE_KEYWORDS` (+10% confidence boost)
- **DEBIT** ‚Üí –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç `SUPPLIER_KEYWORDS` (+5% confidence boost)

#### 5.4. Fallback –ª–æ–≥–∏–∫–∞
–ï—Å–ª–∏ –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º:
- **CREDIT** ‚Üí "–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ (–ø—Ä–∏—Ö–æ–¥)" (confidence 0.6)
- **DEBIT** ‚Üí "–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ (—Ä–∞—Å—Ö–æ–¥)" (confidence 0.5)

#### 5.5. –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –≤—ã–∑–æ–≤—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞
- ‚úÖ [bank_transaction_import.py:293](../backend/app/services/bank_transaction_import.py#L293) - Excel –∏–º–ø–æ—Ä—Ç
- ‚úÖ [bank_transaction_1c_import.py:750](../backend/app/services/bank_transaction_1c_import.py#L750) - 1C –∏–º–ø–æ—Ä—Ç
- ‚úÖ [bank_transactions.py:651](../backend/app/api/v1/bank_transactions.py#L651) - API suggestions

**–í–∞–∂–Ω–æ:** –¢–µ–ø–µ—Ä—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è **–û–ë–û–ò–• —Ç–∏–ø–æ–≤** –æ–ø–µ—Ä–∞—Ü–∏–π (—Ä–∞–Ω—å—à–µ —Ç–æ–ª—å–∫–æ DEBIT)!

**–§–∞–π–ª—ã:**
- [backend/app/services/transaction_classifier.py](../backend/app/services/transaction_classifier.py)

---

## üìä –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –ü—Ä–æ–≥—Ä–µ—Å—Å |
|-----------|------|-------|----------|
| Backend - –ú–æ–¥–µ–ª—å | 100% | 100% | ‚úÖ |
| Backend - API | 95% | 100% | +5% |
| Backend - AI Classifier | 85% | 100% | +15% |
| Backend - OData 1C | 100% | 100% | ‚úÖ |
| Frontend - UI | 95% | 100% | +5% |
| Frontend - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | 0% | 100% | +100% |
| Frontend - –§–∏–ª—å—Ç—Ä—ã | 90% | 100% | +10% |
| –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ | 0% | 100% | +100% |
| –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (Cron) | 0% | 100% | +100% |

**–û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** 85% ‚Üí 100% (+15%)

---

## üéØ –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å

### ‚úÖ –í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!

**–ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:**

#### 6. **–¶–≤–µ—Ç–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã** (–†–∞–∑–¥–µ–ª 9 –¢–ó)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `rowClassName` –≤ Table –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- ‚úÖ CSS —Å—Ç–∏–ª–∏ –¥–ª—è —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã (red/green)
- ‚úÖ CSS —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã
- ‚úÖ **–†–∞—Å—Ö–æ–¥ (DEBIT)** ‚Äî –∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω (#fff1f0)
- ‚úÖ **–ü—Ä–∏—Ö–æ–¥ (CREDIT)** ‚Äî –∑–µ–ª—ë–Ω—ã–π —Ñ–æ–Ω (#f6ffed)

**–§–∞–π–ª—ã:**
- [frontend/src/pages/BankTransactionsPage.tsx:957-967](../frontend/src/pages/BankTransactionsPage.tsx#L957-967)
- [frontend/src/index.css:209-246](../frontend/src/index.css#L209-246)

#### 7. **Cron –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `backend/scripts/sync_1c_hourly.py` –¥–ª—è –≤—Å–µ—Ö –æ—Ç–¥–µ–ª–æ–≤
- ‚úÖ –°–∫—Ä–∏–ø—Ç `backend/scripts/cron_hourly_sync.sh` –≥–æ—Ç–æ–≤
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è `docs/CRON_SETUP.md` –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 24 —á–∞—Å–æ–≤ –∫–∞–∂–¥—ã–π —á–∞—Å
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–æ—Ç–∞—Ü–∏–µ–π

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron:**
```bash
# –û—Ç–∫—Ä—ã—Ç—å crontab
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É (–∫–∞–∂–¥—ã–π —á–∞—Å –≤ :00)
0 * * * * /Users/evgenijsikunov/projects/west/west_buget_it/backend/scripts/cron_hourly_sync.sh
```

**–§–∞–π–ª—ã:**
- [backend/scripts/sync_1c_hourly.py](../backend/scripts/sync_1c_hourly.py)
- [backend/scripts/cron_hourly_sync.sh](../backend/scripts/cron_hourly_sync.sh)
- [docs/CRON_SETUP.md](../docs/CRON_SETUP.md)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ú–∏–≥—Ä–∞—Ü–∏–∏
```bash
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è
alembic upgrade head

# –§–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏
backend/alembic/versions/2025_11_17_0612-6bad3b34ad66_add_payment_source_to_bank_transactions.py
```

### –°–∫—Ä–∏–ø—Ç—ã
```bash
# –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π/–ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
python backend/scripts/add_customer_supplier_categories.py

# –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å AI –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
python backend/scripts/import_ai_categories.py
```

### API Endpoints
```bash
# –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º payment_source
GET /api/v1/bank-transactions?payment_source=BANK

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å –ø–æ–ª–Ω—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
GET /api/v1/bank-transactions/stats?status=NEW&transaction_type=DEBIT&payment_source=BANK

# AI suggestions —Å —Ç–∏–ø–æ–º –æ–ø–µ—Ä–∞—Ü–∏–∏
GET /api/v1/bank-transactions/{id}/category-suggestions
```

---

## üìà –í–ª–∏—è–Ω–∏–µ –Ω–∞ –±–∏–∑–Ω–µ—Å

### –î–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–ª–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤ (DEBIT)
- –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è –¥–æ—Ö–æ–¥–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
- –ù–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
- ‚úÖ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –í–°–ï–• –æ–ø–µ—Ä–∞—Ü–∏–π (DEBIT + CREDIT)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –¥–æ—Ö–æ–¥–æ–≤: "–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ (–ø—Ä–∏—Ö–æ–¥)"
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤: "–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ (—Ä–∞—Å—Ö–æ–¥)"
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–∞—è –º–µ—Ç–∫–∞ "–ê–≤—Ç–æ" –¥–ª—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É (–±–∞–Ω–∫/–∫–∞—Å—Å–∞)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–∞ 90-95% –¥–ª—è —Ç–∏–ø–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π!

---

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ bank_transaction_import.py
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ if/elif –±–ª–æ–∫–∞
```python
# –ë–´–õ–û (–æ—à–∏–±–∫–∞):
if confidence >= 0.9:
    ...
    elif confidence >= 0.5:  # SyntaxError
        ...

# –°–¢–ê–õ–û (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
if confidence >= 0.9:
    ...
elif confidence >= 0.5:
    ...
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ

---

## üìö –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [BANK_TRANSACTIONS_TZ_IMPLEMENTATION_REPORT.md](BANK_TRANSACTIONS_TZ_IMPLEMENTATION_REPORT.md) - –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç
- [BANK_TRANSACTIONS_STATUSES.md](BANK_TRANSACTIONS_STATUSES.md) - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å–æ–≤
- [BANK_TRANSACTIONS_KEYWORDS.md](BANK_TRANSACTIONS_KEYWORDS.md) - –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
- [CLAUDE.md](../CLAUDE.md#üè¶-bank-transactions) - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Claude

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –§–∏–ª—å—Ç—Ä –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É
```typescript
// Frontend
setPaymentSource('BANK')  // –∏–ª–∏ 'CASH'
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
```python
# Backend
if transaction.category_confidence >= 0.9:
    print(f"‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: {transaction.category_name}")
```

### 3. AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å —Ç–∏–ø–æ–º
```python
classifier = TransactionClassifier(db)
category_id, confidence, reasoning = classifier.classify(
    payment_purpose="–û–ø–ª–∞—Ç–∞ –æ—Ç –û–û–û –†–æ–º–∞—à–∫–∞ –∑–∞ —Ç–æ–≤–∞—Ä",
    counterparty_name="–û–û–û –†–æ–º–∞—à–∫–∞",
    counterparty_inn="7701234567",
    amount=Decimal("50000"),
    department_id=1,
    transaction_type="CREDIT"  # –£–∫–∞–∑—ã–≤–∞–µ–º —Ç–∏–ø!
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: category_id ‚Üí "–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ (–ø—Ä–∏—Ö–æ–¥)"
```

---

## ‚ú® –í—ã–≤–æ–¥—ã

**–î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:**
- ‚úÖ –í—Å–µ –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ –í—Å–µ —Å—Ä–µ–¥–Ω–µ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ –í—Å–µ –Ω–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–∞–∫—Å–∏–º—É–º
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó (—Ü–≤–µ—Ç–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ (cron)
- ‚úÖ –ú–æ–¥—É–ª—å –≥–æ—Ç–æ–≤ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** 100% üéä

---

**–î–∞—Ç–∞:** 17 –Ω–æ—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 1.2
**–ê–≤—Ç–æ—Ä:** Claude Code Assistant
