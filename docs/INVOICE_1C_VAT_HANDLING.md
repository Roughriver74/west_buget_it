# Invoice to 1C Integration - VAT Handling & Payment Method

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π (v2)

–î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ù–î–° –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º –æ–ø–ª–∞—Ç—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–æ–∫ –Ω–∞ —Ä–∞—Å—Ö–æ–¥ –≤ 1–°.

## ‚ú® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è –ù–î–°**

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ —Å—á–µ—Ç –ù–î–°, –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—è `invoice.vat_amount`:

```python
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è –ù–î–°
has_vat = bool(invoice.vat_amount and invoice.vat_amount > 0)

if has_vat:
    # –°—á–µ—Ç –° –ù–î–°
    vat_amount = int(invoice.vat_amount)
    amount_without_vat = amount_int - vat_amount
    vat_treatment = "–û–±–ª–∞–≥–∞–µ—Ç—Å—è–ù–î–°"
else:
    # –°—á–µ—Ç –ë–ï–ó –ù–î–°
    vat_amount = 0
    amount_without_vat = amount_int
    vat_treatment = "–ü—Ä–æ–¥–∞–∂–∞–ù–µ–û–±–ª–∞–≥–∞–µ—Ç—Å—è–ù–î–°"
```

### 2. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º –æ–ø–ª–∞—Ç—ã**

–í 1–° –æ–±–µ —Ñ–æ—Ä–º—ã –æ–ø–ª–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å true (–∫–∞–∫ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞—è–≤–∫–∞—Ö):

```python
"–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ù–∞–ª–∏—á–Ω–∞—è": True,       # –û–ë–ï —Ñ–æ—Ä–º—ã
"–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è": True,    # –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å True
"–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ü–ª–∞—Ç–µ–∂–Ω–∞—è–ö–∞—Ä—Ç–∞": False,
```

### 3. **–ü–æ–ª–µ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è –ù–î–°**

–í 1–° —ç—Ç–æ –ø–æ–ª–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **–ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π** (–Ω–µ –ø–µ—Ä–µ–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è):

```python
"–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ–ù–î–°": ""  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
```

### 4. **–ë—é–¥–∂–µ—Ç**

–¢–∞–∫–∂–µ **–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞**:

```python
"–≤—Å_–ï—Å—Ç—å–°–≤–æ–±–æ–¥–Ω—ã–π–ë—é–¥–∂–µ—Ç–ü–æ–ü–ª–∞–Ω—É": ""  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –° –ù–î–° vs –ë–µ–∑ –ù–î–°

### –°—á–µ—Ç –° –ù–î–° (20%)

```json
{
  "–°—É–º–º–∞–î–æ–∫—É–º–µ–Ω—Ç–∞": 12000,
  "–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ–ù–î–°": "",
  "–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ù–∞–ª–∏—á–Ω–∞—è": true,
  "–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è": true,
  "–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ü–ª–∞—Ç–µ–∂–Ω–∞—è–ö–∞—Ä—Ç–∞": false,
  "–≤—Å_–ï—Å—Ç—å–°–≤–æ–±–æ–¥–Ω—ã–π–ë—é–¥–∂–µ—Ç–ü–æ–ü–ª–∞–Ω—É": "",
  "–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ–ü–ª–∞—Ç–µ–∂–∞": "–û–ø–ª–∞—Ç–∞ –ø–æ —Å—á–µ—Ç—É ‚Ññ123\n–í —Ç.—á. –ù–î–° (20%) 2000 —Ä—É–±.",
  "–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞–ü–ª–∞—Ç–µ–∂–∞": [
    {
      "–°—É–º–º–∞": 12000,
      "–°—É–º–º–∞–ë–µ–∑–ù–î–°": 10000,
      "–°—É–º–º–∞–ù–î–°": 2000,
      "–°—Ç–∞–≤–∫–∞–ù–î–°_Key": "ed59436e-f9dc-11ee-ad54-74563c634acb"  // 20%
    }
  ]
}
```

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```
üìã Expense request preparation:
   Invoice ID: 123
   Total amount: 12000 —Ä—É–±.
   Has VAT: –î–∞
   VAT amount: 2000 —Ä—É–±.
   Amount without VAT: 10000 —Ä—É–±.
   Payment method: –ù–∞–ª–∏—á–Ω–∞—è + –ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è (–æ–±–∞)
   User: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á
```

### –°—á–µ—Ç –ë–ï–ó –ù–î–°

```json
{
  "–°—É–º–º–∞–î–æ–∫—É–º–µ–Ω—Ç–∞": 12000,
  "–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ–ù–î–°": "",
  "–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ù–∞–ª–∏—á–Ω–∞—è": true,
  "–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è": true,
  "–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ü–ª–∞—Ç–µ–∂–Ω–∞—è–ö–∞—Ä—Ç–∞": false,
  "–≤—Å_–ï—Å—Ç—å–°–≤–æ–±–æ–¥–Ω—ã–π–ë—é–¥–∂–µ—Ç–ü–æ–ü–ª–∞–Ω—É": "",
  "–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ–ü–ª–∞—Ç–µ–∂–∞": "–û–ø–ª–∞—Ç–∞ –ø–æ —Å—á–µ—Ç—É ‚Ññ124",
  "–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞–ü–ª–∞—Ç–µ–∂–∞": [
    {
      "–°—É–º–º–∞": 12000,
      "–°—É–º–º–∞–ë–µ–∑–ù–î–°": 12000,
      "–°—É–º–º–∞–ù–î–°": 0,
      "–°—Ç–∞–≤–∫–∞–ù–î–°_Key": "00000000-0000-0000-0000-000000000000"  // –ü—É—Å—Ç–æ–π GUID
    }
  ]
}
```

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```
üìã Expense request preparation:
   Invoice ID: 124
   Total amount: 12000 —Ä—É–±.
   Has VAT: –ù–µ—Ç
   VAT amount: 0 —Ä—É–±.
   Amount without VAT: 12000 —Ä—É–±.
   Payment method: –ù–∞–ª–∏—á–Ω–∞—è + –ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è (–æ–±–∞)
   User: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á
```

## üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### InvoiceTo1CConverter (`invoice_to_1c_converter.py`)

```python
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è –ù–î–°
has_vat = bool(invoice.vat_amount and invoice.vat_amount > 0)

if has_vat:
    vat_amount = int(invoice.vat_amount)
    amount_without_vat = amount_int - vat_amount
else:
    vat_amount = 0
    amount_without_vat = amount_int

# –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞
payment_purpose = invoice.payment_purpose or f"–û–ø–ª–∞—Ç–∞ –ø–æ —Å—á–µ—Ç—É ‚Ññ{invoice.invoice_number}"
if has_vat and vat_amount > 0:
    payment_purpose += f"\n–í —Ç.—á. –ù–î–° (20%) {vat_amount} —Ä—É–±."

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logger.info(
    f"üìã Expense request preparation:\n"
    f"   Has VAT: {'–î–∞' if has_vat else '–ù–µ—Ç'}\n"
    f"   VAT amount: {vat_amount} —Ä—É–±.\n"
    f"   Payment method: –ù–∞–ª–∏—á–Ω–∞—è + –ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è (–æ–±–∞)"
)

# –î–∞–Ω–Ω—ã–µ –¥–ª—è 1–°
expense_request_data = {
    # –§–æ—Ä–º—ã –æ–ø–ª–∞—Ç—ã (–û–ë–ï true, –∫–∞–∫ –≤ —Ä–∞–±–æ—á–∏—Ö –∑–∞—è–≤–∫–∞—Ö 1–°)
    "–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ù–∞–ª–∏—á–Ω–∞—è": True,
    "–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è": True,
    "–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ü–ª–∞—Ç–µ–∂–Ω–∞—è–ö–∞—Ä—Ç–∞": False,

    # –ù–î–° (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)
    "–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ–ù–î–°": "",

    # –ë—é–¥–∂–µ—Ç (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)
    "–≤—Å_–ï—Å—Ç—å–°–≤–æ–±–æ–¥–Ω—ã–π–ë—é–¥–∂–µ—Ç–ü–æ–ü–ª–∞–Ω—É": "",

    # –¢–∞–±–ª–∏—á–Ω–∞—è —á–∞—Å—Ç—å
    "–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞–ü–ª–∞—Ç–µ–∂–∞": [
        {
            "–°—É–º–º–∞": amount_int,
            "–°—É–º–º–∞–ë–µ–∑–ù–î–°": amount_without_vat,
            "–°—É–º–º–∞–ù–î–°": vat_amount,
            "–°—Ç–∞–≤–∫–∞–ù–î–°_Key": self.VAT_20_PERCENT_GUID if vat_amount > 0 else self.EMPTY_GUID,
        }
    ]
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
cd backend

# –¢–µ—Å—Ç —Å –ù–î–° (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python scripts/test_invoice_with_attachment.py

# –¢–µ—Å—Ç –±–µ–∑ –ù–î–°
python scripts/test_invoice_with_attachment.py no-vat

# –û–±–∞ —Ç–µ—Å—Ç–∞
python scripts/test_invoice_with_attachment.py both
```

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

#### –¢–µ—Å—Ç —Å –ù–î–°:
```
üß™ TEST 1: –°—á–µ—Ç –° –ù–î–°
================================================================================

üìã Test data prepared:
   Total amount: 2000 —Ä—É–±.
   Has VAT: –î–∞
   VAT amount: 333 —Ä—É–±.
   Amount without VAT: 1667 —Ä—É–±.
   VAT treatment: –û–±–ª–∞–≥–∞–µ—Ç—Å—è–ù–î–°
   Payment method: –ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è

‚úÖ Expense request created successfully!
‚úÖ Attachment uploaded successfully!
```

#### –¢–µ—Å—Ç –±–µ–∑ –ù–î–°:
```
üß™ TEST 2: –°—á–µ—Ç –ë–ï–ó –ù–î–°
================================================================================

üìã Test data prepared:
   Total amount: 2000 —Ä—É–±.
   Has VAT: –ù–µ—Ç
   VAT amount: 0 —Ä—É–±.
   Amount without VAT: 2000 —Ä—É–±.
   VAT treatment: –ü—Ä–æ–¥–∞–∂–∞–ù–µ–û–±–ª–∞–≥–∞–µ—Ç—Å—è–ù–î–°
   Payment method: –ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è

‚úÖ Expense request created successfully!
‚úÖ Attachment uploaded successfully!
```

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ 1–°

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:

### –û–±—â–∏–µ –ø–æ–ª—è (–¥–ª—è –æ–±–æ–∏—Ö —Å–ª—É—á–∞–µ–≤):
- ‚úÖ **Posted**: true (–¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–æ–≤–µ–¥–µ–Ω)
- ‚úÖ **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π**: "–ò–≤–∞–Ω–æ–≤ –ò.–ò.: —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è"
- ‚úÖ **–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ù–∞–ª–∏—á–Ω–∞—è**: true
- ‚úÖ **–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è**: true
- ‚úÖ **–§–æ—Ä–º–∞–û–ø–ª–∞—Ç—ã–ü–ª–∞—Ç–µ–∂–Ω–∞—è–ö–∞—Ä—Ç–∞**: false
- ‚úÖ **–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ–ù–î–°**: "" (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ **–≤—Å_–ï—Å—Ç—å–°–≤–æ–±–æ–¥–Ω—ã–π–ë—é–¥–∂–µ—Ç–ü–æ–ü–ª–∞–Ω—É**: "" (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ **–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª**: –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç

### –î–ª—è —Å—á–µ—Ç–∞ –° –ù–î–°:
- ‚úÖ **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ–ü–ª–∞—Ç–µ–∂–∞**: —Å–æ–¥–µ—Ä–∂–∏—Ç "–í —Ç.—á. –ù–î–° (20%) XXX —Ä—É–±."
- ‚úÖ **–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞–ü–ª–∞—Ç–µ–∂–∞**:
  - –°—É–º–º–∞–ù–î–°: > 0
  - –°—Ç–∞–≤–∫–∞–ù–î–°_Key: GUID —Å—Ç–∞–≤–∫–∏ 20% (ed59436e-f9dc-11ee-ad54-74563c634acb)

### –î–ª—è —Å—á–µ—Ç–∞ –ë–ï–ó –ù–î–°:
- ‚úÖ **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ–ü–ª–∞—Ç–µ–∂–∞**: –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ù–î–°
- ‚úÖ **–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞–ü–ª–∞—Ç–µ–∂–∞**:
  - –°—É–º–º–∞–ù–î–°: 0
  - –°—Ç–∞–≤–∫–∞–ù–î–°_Key: –ø—É—Å—Ç–æ–π GUID (00000000-0000-0000-0000-000000000000)

## üîç –û—Ç–ª–∞–¥–∫–∞

### –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
import logging
logging.getLogger("app.services.invoice_to_1c_converter").setLevel(logging.DEBUG)
```

### –õ–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

```
üìã Expense request preparation:
   Invoice ID: 123
   Total amount: 12000 —Ä—É–±.
   Has VAT: –î–∞/–ù–µ—Ç
   VAT amount: XXX —Ä—É–±.
   Amount without VAT: XXX —Ä—É–±.
   VAT treatment: –û–±–ª–∞–≥–∞–µ—Ç—Å—è–ù–î–°/–ü—Ä–æ–¥–∞–∂–∞–ù–µ–û–±–ª–∞–≥–∞–µ—Ç—Å—è–ù–î–°
   Payment method: –ë–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è
   User: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á
```

## üö® Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ù–î–°

**–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ª–µ `invoice.vat_amount` –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å OCR/AI –ø–∞—Ä—Å–∏–Ω–≥ —Å—á–µ—Ç–∞
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `vat_amount` –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä—É—á–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ invoice

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ '–¢–∏–ø—ã–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è–ù–î–°' –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —ç–ª–µ–º–µ–Ω—Ç..."

**–ü—Ä–∏—á–∏–Ω–∞**: 1–° –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è `–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ–ù–î–°`

**–†–µ—à–µ–Ω–∏–µ**:
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É** `""` –¥–ª—è –ø–æ–ª—è `–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ–ù–î–°`
2. ‚úÖ –í 1–° —ç—Ç–æ –ø–æ–ª–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º
3. ‚úÖ –ù–î–° —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—á–Ω—É—é —á–∞—Å—Ç—å `–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞–ü–ª–∞—Ç–µ–∂–∞` (–ø–æ–ª—è `–°—É–º–º–∞–ù–î–°` –∏ `–°—Ç–∞–≤–∫–∞–ù–î–°_Key`)

### –ü—Ä–æ–±–ª–µ–º–∞: –§–æ—Ä–º–∞ –æ–ø–ª–∞—Ç—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞**: –í 1–° –º–æ–∂–µ—Ç –±—ã—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—ã –æ–ø–ª–∞—Ç—ã

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ OData –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ 1–° (–ü—Ä–∏–ó–∞–ø–∏—Å–∏, –ü–µ—Ä–µ–¥–ó–∞–ø–∏—Å—å—é)
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Ñ–æ—Ä–º–∞ –æ–ø–ª–∞—Ç—ã = true

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- [Invoice to 1C Integration Guide](INVOICE_TO_1C_INTEGRATION.md)
- [File Attachment Update](INVOICE_1C_FILE_ATTACHMENT_UPDATE.md)
- [1C OData Integration](1C_ODATA_INTEGRATION.md)

## üéØ Summary

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
1. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ù–î–° (—á–µ—Ä–µ–∑ `invoice.vat_amount`)
2. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º –æ–ø–ª–∞—Ç—ã (–æ–±–µ true: –Ω–∞–ª–∏—á–Ω–∞—è + –±–µ–∑–Ω–∞–ª–∏—á–Ω–∞—è)
3. ‚úÖ –ü–æ–ª–µ `–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ–ù–î–°`: –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ (–Ω–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ!)
4. ‚úÖ –ü–æ–ª–µ `–≤—Å_–ï—Å—Ç—å–°–≤–æ–±–æ–¥–Ω—ã–π–ë—é–¥–∂–µ—Ç–ü–æ–ü–ª–∞–Ω—É`: –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
5. ‚úÖ –ù–î–° –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—á–Ω—É—é —á–∞—Å—Ç—å (`–°—É–º–º–∞–ù–î–°`, `–°—Ç–∞–≤–∫–∞–ù–î–°_Key`)
6. ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
7. ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è –æ–±–æ–∏—Ö —Å–ª—É—á–∞–µ–≤ (—Å/–±–µ–∑ –ù–î–°)
8. ‚úÖ –§–∞–π–ª—ã –ø—Ä–∏–∫—Ä–µ–ø–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ó–∞—è–≤–∫–∏ –Ω–∞ —Ä–∞—Å—Ö–æ–¥ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ 1–°
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω—ã (Posted=true)
- ‚úÖ –§–∞–π–ª—ã –ø—Ä–∏–∫—Ä–µ–ø–ª—è—é—Ç—Å—è –∫ –∑–∞—è–≤–∫–∞–º
- ‚úÖ –ù–î–° –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—á–Ω–æ–π —á–∞—Å—Ç–∏
- ‚úÖ –§–æ—Ä–º—ã –æ–ø–ª–∞—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∑–∞—è–≤–∫–∞–º –≤ 1–°
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
